(f)lexやyaccなどの構文解析を試してはどうか